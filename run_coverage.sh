#!/bin/bash

# First off, run the tests
make -j$(($(getconf _NPROCESSORS_ONLN)+1))
make check

# Get some coverage on the CLI tooling
./src/cli/cve-check-tool
./src/cli/cve-check-tool help
# Run unknown command
./src/cli/cve-check-tool bob
./src/cli/cve-check-tool help update
# Unknown help
./src/cli/cve-check-tool help bob
./src/cli/cve-check-tool help help
./src/cli/cve-check-tool version

# Nuke old tree
if [[ -d coverage ]]; then
        rm -rf coverage
fi

# Regen html
make coverage
